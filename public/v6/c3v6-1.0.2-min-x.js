function c3_submitIt(){var e=document.c3_taskFrm;if(e.task_name.value.length<2)return alert("please input your task name"),e.task_name.focus(),!1;var t="";return t.length<1?(client&&client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"jquery","c3-mod":"definition"},$(document.c3_taskFrm).serialize()),!1):void alert(t)}function onmessage_definition(e){var t=JSON.parse(e);return t.uid==c3_protocol[0]?($("#definition_onmessage")[0].innerText="["+(new Date).format("hh:mm:ss")+"] "+t.message+"@"+username,void $("#btn_definition").removeAttr("disabled")):void($("#definition_onmessage")[0].innerText="["+(new Date).format("hh:mm:ss")+"] "+e)}function onclose_definition(e){$("#definition_onmessage")[0].innerText="["+(new Date).format("hh:mm:ss")+"] Disconnected",$("#btn_definition").attr("disabled","disabled")}function c3_addRow(e,t){table=e.parentNode.parentNode,pos=e.rowIndex,i=0,e=table.insertRow(pos),cell=e.insertCell(i++),cell.setAttribute("align","left"),cell.innerHTML='<input type="text" name="'+t+'_name[]" />',cell=e.insertCell(i++),cell.setAttribute("align","left"),"condition"==t?cell.innerHTML='<select name="'+t+'_type[]" style="width:75px"><option value="crontab">crontab</option><option value="post">post</option><option value="api">api</option><option value="due" selected>due</option><option value="hook">hook</option></select>':"action"==t&&(cell.innerHTML='<select name="'+t+'_type[]" style="width:75px"><option value="api">api</option><option value="post">post</option><option value="queue">queue</option></select>'),cell=e.insertCell(i++),cell.setAttribute("align","left"),cell.innerHTML='<input type="text" name="'+t+'_spec[]" />',cell=e.insertCell(i++),cell.setAttribute("align","left"),cell.innerHTML='<input type="text" name="'+t+'_payload[]" />',"condition"==t&&(cell=e.insertCell(i++),cell.setAttribute("align","left"),cell.setAttribute("nowrap","nowrap"),cell.innerHTML=' <input type="text" name="'+t+'_eval[]">')}function firstform_submit(){var e=$("#first form input").val();if(e){if(e.startsWith("connect")){client=null;var t=e.split(" ");return 2!=t.length?(client_onreceive({body:"bad CONNECT format, e.g. connect UID/PASSWORD",headers:{}}),$("#first form input").val(""),!1):(t=t[1].split("/"),2!=t.length?(client_onreceive({body:"bad CONNECT format, e.g. connect UID/PASSWORD",headers:{}}),$("#first form input").val(""),!1):(username=t[0],client=Stomp.over(new WebSocket("ws"+("https:"==document.location.protocol.toLowerCase()?"s":"")+"://www.conby.com/ws")),client.debug=client_debug,client.onreceive=client_onreceive,client.onclose=client_onclose,client.connect(username,t[1],on_connect,on_error,"c3"),$("#first form input").val(""),!1))}if(client&&e.startsWith("disconnect"))return client.disconnect(),client_onclose(null),client=null,client_onreceive({body:"disconnected",headers:{}}),$("#first form input").val(""),!1;if(!client)return client_onreceive({body:"not connected, please connect first",headers:{}}),$("#first form input").val(""),!1;var n={uid:document.getElementById("username").value,message:e};client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"json","c3-mod":"console"},JSON.stringify(n)),$("#first form input").val("")}return!1}function xx(){}function createChatEntry3(e,t){var n=document.createElement("div");n.class="chat_entry";var s=document.createElement("span");s.class="chat_username",s.innerHTML="["+(new Date).format("hh:mm:ss")+"] "+e+": ",n.appendChild(s);var o=document.createElement("span");return o.class="chat_message",o.innerHTML=t,n.appendChild(o),n}function getHeader3(e,t,n,s,o){for(var r=['<svg height="',s.toString(),'" width="',n.toString(),'">','<g transform="translate(',e.toString(),",",t.toString(),')">','  <g class="x axis">'].join(""),a=0;a<6;a++)r+='    <g transform="translate(',(100*a*(n/600)).toString(),Math.round(100*a*(o/600)).toString(),"</text></g>";return r+=['    <path d="M0,-6V0H',n.toString(),'V-6" class="domain"></path>','    <text transform="translate(',(n-e).toString(),', -9)"></text>',"  </g>",'  <g class="y axis"><path d="M-6,0H0V',s.toString(),'H-6" class="domain"></path></g>'].join("")}function checkJSONChart3(e){var t=null,n=null;try{if(n=JSON.parse(e),t=new Array,n&&"object"==typeof n){for(var s in n)try{isNaN(n[s])===!1&&(t[t.length]=parseInt(n[s]))}catch(e){pass}if(t.length>1){var o=10,r=20,a=600,i=Math.max.apply({},t),c=5*t.length*2+r,l="";l+=getHeader3(o,r,a,c,i);var d=0;for(var u in t)d+=1,l+='  <g class="bar" transform="translate(0,'+(10*d-5).toString()+')"><rect height="5" width="'+Math.round(1*t[u]*(a-o)/i).toString()+'"></rect></g>\n';return l+=["</g>","</svg>"].join(""),t&&(t.length=0,delete t),d=null,o=null,r=null,a=null,i=null,c=null,t=null,n=null,l}}}catch(e){return t&&(t.length=0,delete t),t=null,n=null,""}return t&&(t.length=0,delete t),t=null,n=null,""}function checkJSONString3(e){var t=null;try{if(t=JSON.parse(e),t&&"object"==typeof t){var n="<table border=1>";for(var s in t)n+="<tr>",n+="<td>"+s+"</td>",n+=t[s]&&"object"==typeof t[s]?"<td>"+JSON.stringify(t[s])+"</td>":"<td>"+t[s]+"</td>",n+="</tr>";return n+="</table>",n+=checkJSONChart3(e),t=null,n}}catch(n){return t=null,e}return t=null,e}function onmessage_event(e){var t=JSON.parse(e);if(t.uid==c3_protocol[0])return document.getElementById("username3").value=t.message+"@"+username,void $("#message3").removeAttr("readonly");var n=createChatEntry3(t.uid,checkJSONString3(t.message));messageContainer3.appendChild(n),n.parentNode.scrollTop=n.offsetTop}function onclose_event(e){document.getElementById("username3").value="Disconnected",$("#message3").attr("readonly","readonly")}function oninit_event(e){event_init||(client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo"},"hi event"),event_init=!0)}function sendMessage3(){var e={uid:document.getElementById("username3").value,message:document.getElementById("message3").value};e.uid&&e.message&&client&&client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"json","c3-mod":"event"},JSON.stringify(e)),document.getElementById("message3").value=""}function createChatEntry(e,t){var n=document.createElement("div");n.class="chat_entry";var s=document.createElement("span");s.class="chat_username",s.innerHTML="["+(new Date).format("hh:mm:ss")+"] "+e+": ",n.appendChild(s);var o=document.createElement("span");return o.class="chat_message",o.innerHTML=t,n.appendChild(o),setTimeout(function(){n.style.display="none"},2e3),n}function handleJsonSource(e){/.*\.json$/.test(e)?document.getElementById("yarn_jsonsource").value=e+"?t="+(new Date).valueOf():document.getElementById("yarn_jsonsource").value=e}function checkJSONString(e){var t=null;try{if(t=JSON.parse(e),t&&"object"==typeof t){var n="",s="";for(var o in t)"yarn_jsonsource"==o&&handleJsonSource(t[o]),"yarn_event"==o&&(n=t[o]+" "),"yarn_updated"==o&&(s=t[o]),"yarn_vtype"==o&&(document.getElementById("select_vtype").value=t[o]);return t=null,n+s}}catch(n){return t=null,e}return t=null,e}function onmessage_visualization(e){var t=JSON.parse(e);if(t.uid==c3_protocol[0])return document.getElementById("username").value=t.message+"@"+username,void $("#message").removeAttr("readonly");var n=createChatEntry(t.uid,checkJSONString(t.message));messageContainer.replaceChild(n,mc),mc=n,onVtypeChange(document.getElementById("select_vtype").value)}function onclose_visualization(e){document.getElementById("username").value="Disconnected",$("#message").attr("readonly","readonly")}function oninit_visualization(e){visualization_init||(client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo"},"hi visualization"),visualization_init=!0)}function sendMessage(){var e={uid:document.getElementById("username").value,message:document.getElementById("message").value};e.uid&&e.message&&client&&client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"json","c3-mod":"visualization"},JSON.stringify(e)),document.getElementById("message").value=""}function onVtypeChange(e){switch(document.getElementById("sunburstpartition_radio").style.display="none",document.getElementById("hierarchicaledgebundling_range").style.display="none",document.getElementById("treemap_select").style.display="none",document.getElementById("jsonsource").value="flare.json",e){case"timeline":c3dv.css("c3js/v_timeline.css"),c3dv.js("c3js/bootstrap-tooltip.js"),c3dv.js("c3js/v_timeline.js");break;case"areagradient":c3dv.css("c3js/v_areagradient.css"),c3dv.js("c3js/v_areagradient.js");break;case"barhierarchy":c3dv.css("c3js/v_barhierarchy.css"),c3dv.js("c3js/v_barhierarchy.js");break;case"chart":c3dv.css("c3js/v_chart.css"),c3dv.js("c3js/v_chart.js");break;case"bubblechart":c3dv.css("c3js/v_bubblechart.css"),c3dv.js("c3js/v_bubblechart.js");break;case"bubbleby":c3dv.css("c3js/v_bubbleby.css"),c3dv.js("c3js/v_bubbleby.js");break;case"showreel":c3dv.css("c3js/v_showreel.css"),c3dv.js("c3js/v_showreel.js");break;case"cluster":c3dv.css("c3js/v_cluster.css"),c3dv.js("c3js/v_cluster.js");break;case"chorddiagram":c3dv.css("c3js/v_chorddiagram.css"),c3dv.js("c3js/v_chorddiagram.js");break;case"hierarchicaledgebundling":c3dv.css("c3js/v_hierarchicaledgebundling.css"),c3dv.js("c3js/v_hierarchicaledgebundling.js");break;case"forcecollapsible":c3dv.css("c3js/v_forcecollapsible.css"),c3dv.js("c3js/v_forcecollapsible.js");break;case"forcedirectedgraph":c3dv.css("c3js/v_forcedirectedgraph.css"),c3dv.js("c3js/v_forcedirectedgraph.js");break;case"packhierarchy":c3dv.css("c3js/v_packhierarchy.css"),c3dv.js("c3js/v_packhierarchy.js");break;case"radial":c3dv.css("c3js/v_radial.css"),c3dv.js("c3js/v_radial.js");break;case"partition":c3dv.css("c3js/v_partition.css"),c3dv.js("c3js/v_partition.js");break;case"bilevelpartition":c3dv.css("c3js/v_bilevelpartition.css"),c3dv.js("c3js/v_bilevelpartition.js");break;case"sunburstpartition":c3dv.css("c3js/v_sunburstpartition.css"),c3dv.js("c3js/v_sunburstpartition.js");break;case"sequencessunburst":c3dv.css("c3js/v_sequencessunburst.css"),c3dv.js("c3js/v_sequencessunburst.js");break;case"treemap":c3dv.css("c3js/v_treemap.css"),c3dv.js("c3js/v_treemap.js");break;case"ddzpcta":c3dv.css("c3js/v_ddzpcta.css"),c3dv.js("c3js/v_ddzpcta.js");break;default:c3dv.css("c3js/v_forcecollapsible.css"),c3dv.js("c3js/v_forcecollapsible.js")}}function send_c3message(e,t){var n=$("#three form input").val();if(n){var s=t;s||(s=n);var o={uid:document.getElementById("username").value,message:{api:e,key:s}};o.uid&&o.message&&client&&client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"json","c3-mod":"workflow"},JSON.stringify(o))}}function set_c3_world_dimension(e,t,n){var s=document.getElementById(n);s.style.width=e+"px",s.style.height=t+"px",Joint.paper(n,e,t+150)}function onmessage_workflow(e){var t=JSON.parse(e);return t.uid==c3_protocol[0]?($("#three form input").removeAttr("readonly"),void(document.getElementById("wf_task_name").innerText="No task key")):void show_task(t.message)}function onclose_workflow(e){$("#three form input").attr("readonly","readonly"),document.getElementById("task_desc").style.display="none",document.getElementById("runtimes").style.display="none"}function show_task(e){document.getElementById("task_desc").style.display="",document.getElementById("runtimes").style.display="",document.getElementById("wf_task_name").innerText=e.taskname,document.getElementById("wf_task_created").innerText=e.created,document.getElementById("wf_task_fcount").innerText=e.fcount;var t=document.getElementById("runtimes");t.innerHTML='<h2 class="comments">Runtime(s)</h2>';for(var n=0;n<e.runtime_list.length;n++)create_runtime_div(n+1,e.runtime_list[n]),create_runtime(n+1,e.runtime_list[n])}function create_runtime(e,t){var n=Joint.dia.devs,s=n.arrow,o=[600,20,100,220,130,450,100];navigator.userAgent.match(/mobile/i)&&(o=[333,20,50,120,80,255,50]),set_c3_world_dimension(o[0],68,"c3workflow_world"+e.toString());var r=t;r.source.p1.push("in"),r.follower.p1.push("out");var a=n.Model.create({rect:{x:o[3],y:10,width:o[4],height:40},label:r.name,attrs:{fill:"green"},labelAttrs:{"font-weight":"bold",fill:"white","font-size":"12px"},shadow:!0,iPorts:r.source.p1.unique(),oPorts:r.follower.p1.unique()}),i=0,c=0,l=35;for(var d in r.source.rt){r.source.rt[d].p1.push("out"),c=10+i*l,i+=1;var u=n.Model.create({rect:{x:o[1],y:c,width:o[2],height:30},label:r.source.rt[d].runtime_name,labelAttrs:{"font-weight":"bold",fill:"white","font-size":"12px"},attrs:{fill:"red"},shadow:!0,iPorts:["in"],oPorts:r.source.rt[d].p1.unique()});u.wrapper.dblclick(function(e){document.location="#"+r.source.rt[d].taskkey});for(var m in r.source.rt[d].p2)u.port("o",m).joint(a.port("i",r.source.rt[d].p2[m]),s)}i=0,c=0;for(var d in r.follower.rt){r.follower.rt[d].p1.push("in"),c=10+i*l,i+=1;var v=n.Model.create({rect:{x:o[5],y:c,width:o[6],height:30},label:r.follower.rt[d].runtime_name,attrs:{fill:"red"},labelAttrs:{"font-weight":"bold",fill:"white","font-size":"12px"},shadow:!0,iPorts:r.follower.rt[d].p1.unique(),oPorts:["out"]});v.wrapper.dblclick(function(e){document.location="#"+r.follower.rt[d].taskkey});for(var m in r.follower.rt[d].p2)a.port("o",m).joint(v.port("i",r.follower.rt[d].p2[m]),s)}}function create_runtime_div(e,t){var n='\t<div class="comment comment-published odd">';n+='\t  <div class="clear-block">',n+='\t\t<span class="submitted" style="float: right">'+t.updated+" - "+t.status+"</span>",n+="\t\t<h4>"+t.key+"</h4>",n+='\t\t<div class="content">',n+="\t\t  <p>   ",n+='\t\t   <table width="100%" border="0" cellpadding="2" cellspacing="1" class="wftab">';for(var s=0;s<t.content.length;s++){var o=t.content[s][0]?":":"",r=$("<div/>").text(t.content[s][1]).html();n+='\t\t      <tr><td class="wftdl" nowrap>'+t.content[s][0]+o+'</td></td><td class="wftdm">&nbsp;</td><td class="wftdr" nowrap>'+r+"</td></tr>"}n+="          </table>",n+="\t\t  </p>",n+="\t\t</div>",n+='\t\t<div id="c3workflow_world'+e.toString()+'"></div>',n+="\t  </div>",n+='\t  <div class="links">',n+='\t\t<ul class="links">',n+='\t\t  <li class="rt_stop first" style="display:inline"><a href="javascript:send_c3message(\'c3_stop_runtime\',\''+t.key+"');\"> Stop</a></li>",n+='\t\t  <li class="rt_delete first" style="display:inline"><a href="javascript:send_c3message(\'c3_delete_runtime\',\''+t.key+"');\"> Delete</a></li>",n+='\t\t  <li class="rt_activate" style="display:inline"><a href="javascript:send_c3message(\'c3_activate_runtime\',\''+t.key+"');\"> Activate</a></li>",n+='\t\t  <li class="rt_promote" style="display:inline"><a href="javascript:send_c3message(\'c3_promote_runtime\',\''+t.key+"');\"> Promote</a></li>",n+='\t\t  <li class="rt_logs last" style="display:inline"><a href="javascript:return false;"> Logs </a></li>',n+="\t\t</ul>",n+="\t  </div>",n+="\t</div>";var a=document.getElementById("runtimes"),i=document.createElement("div");i.innerHTML=n,a.appendChild(i)}var client,username,on_connect,on_error,c3_protocol=["OK1","OK2","OK3"];"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e}),username="test";var client_debug=function(e){var t=$("#second div");t.append($("<code>").text(e)),t.scrollTop(t.scrollTop()+1e4)},client_onreceive=function(e){var t=$("#first div");switch(t.append($("<code>").text(e.body)),t.scrollTop(t.scrollTop()+1e4),e.headers["c3-mod"]){case"event":onmessage_event(e.body);break;case"visualization":onmessage_visualization(e.body);break;case"definition":onmessage_definition(e.body);break;case"workflow":onmessage_workflow(e.body);break;case"initialization":onmessage_visualization(e.body),onmessage_event(e.body),onmessage_definition(e.body),onmessage_workflow(e.body)}},client_onclose=function(e){client_onreceive({body:"client_onclose...",headers:{}}),null!=client&&(onclose_event(e),onclose_visualization(e),onclose_definition(e),onclose_workflow(e))};on_connect=function(e){client.send("/queue/hook_event_queue",{"reply-to":"/temp-queue/foo","c3-type":"request_task","c3-format":"json","c3-mod":"initialization"},"hi")},on_error=function(e){console.log("error "+e)},$("#first form").keydown(function(e){if(13==e.keyCode)return firstform_submit()});var messageContainer3=null;Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var event_init=!1,mc=null,ow=910,oh=800,svg=null,messageContainer=null,c3dv={css:function(e){var t=document.getElementById("c3dvcss"),n=document.head||document.getElementsByTagName("head")[0];t&&(n.removeChild(t),t=null);var s=document.createElement("link");return s.id="c3dvcss",s.href=e,s.rel="stylesheet",s.type="text/css",n.appendChild(s),s},js:function(e){var t=document.getElementById("c3dvjs"),n=document.head||document.getElementsByTagName("head")[0];t&&(n.removeChild(t),t=null);var s=document.createElement("script");return s.id="c3dvjs",s.src=e,s.type="text/javascript",n.appendChild(s),s}};Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var visualization_init=!1;window.onload=function(){messageContainer3=document.getElementById("chat3"),"WebSocket"in window?messageContainer3.appendChild(createChatEntry3("C3","Input C3 Hook, e.g. c3://1aec91bc081c11e4903e4ed6eaf04282.xc")):messageContainer3.appendChild(createChatEntry3("C3","WebSocket is NOT supported by your browser!")),messageContainer=document.getElementById("chat"),mc="WebSocket"in window?messageContainer.appendChild(createChatEntry("C3","Input C3 Hook, e.g. c3://1aec91bc081c11e4903e4ed6eaf04282.xc")):messageContainer.appendChild(createChatEntry("C3","WebSocket is NOT supported by your browser!")),ow=document.getElementById("chat").offsetWidth,oh=document.getElementById("chat").offsetHeight,$("#message").keydown(function(e){if(13==e.keyCode)return sendMessage(),!1}),$("#message3").keydown(function(e){if(13==e.keyCode)return sendMessage3(),!1})},$("#three form").keydown(function(e){if(13==e.keyCode)return send_c3message("c3_get_task",""),!1}),Array.prototype.unique=function(){for(var e=[],t=0;t<this.length;t++)e.indexOf(this[t])==-1&&e.push(this[t]);return e};var ascensor=$("#c3Building").ascensor({childType:"section",ascensorFloorName:["Home","Definition","Publish","Event","Visualization","Workflow","SDK","License"],time:250,windowsOn:0,direction:[[1,0],[2,0],[2,1],[2,2],[2,3],[1,3],[0,3],[0,2]],easing:"easeInOutQuad",keyNavigation:!0,queued:"y"}),ascensorInstance=$("#c3Building").data("ascensor");$(".links-to-floor li").click(function(e,t){ascensorInstance.scrollToFloor($(this).index())}),$(".links-to-floor li:eq("+ascensor.data("current-floor")+")").addClass("selected"),ascensor.on("scrollStart",function(e,t){$(".links-to-floor li").removeClass("selected"),$(".links-to-floor li:eq("+t.to+")").addClass("selected")}),$(".prev").click(function(){ascensorInstance.prev()}),$(".next").click(function(){ascensorInstance.next()}),$(".direction").click(function(){ascensorInstance.scrollToDirection($(this).data("direction"))});