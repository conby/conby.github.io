function updateVtypeChange(t){json_source=JSON.parse(t);var n=json_source;svg.selectAll("*").remove(),start(n)}function start(t){function n(t){if(t.children){a=(t.y?w-40:w)/(1-t.y),o=h/t.dx,x.domain([t.y,1]).range([t.y?40:0,w]),y.domain([t.x,t.x+t.dx]);var n=r.transition().duration(d3.event.altKey?7500:750).attr("transform",function(t){return"translate("+x(t.y)+","+y(t.x)+")"});n.select("rect").attr("width",t.dy*a).attr("height",function(t){return t.dx*o}),n.select("text").attr("transform",e).style("opacity",function(t){return t.dx*o>12?1:0}),d3.event.stopPropagation()}}function e(t){return"translate(8,"+t.dx*o/2+")"}var r=svg.selectAll("g").data(partition.nodes(t)).enter().append("svg:g").attr("transform",function(t){return"translate("+x(t.y)+","+y(t.x)+")"}).on("click",n),a=w/t.dx,o=h/1;r.append("svg:rect").attr("width",t.dy*a).attr("height",function(t){return t.dx*o}).attr("class",function(t){return t.children?"parent":"child"}),r.append("svg:text").attr("transform",e).attr("dy",".35em").style("opacity",function(t){return t.dx*o>12?1:0}).text(function(t){return t.name}),d3.select(window).on("click",function(){n(t)})}w=ow,h=oh,x=d3.scale.linear().range([0,w]),y=d3.scale.linear().range([0,h]),svg&&svg.remove(),svg=d3.select("#chat").append("svg:svg").attr("width",w).attr("height",h);var partition=d3.layout.partition().value(function(t){return t.size});json_source?start(json_source):d3.json(document.getElementById("jsonsource").value,function(t){start(t)});